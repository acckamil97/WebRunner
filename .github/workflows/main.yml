name: sfdx

on:
  workflow_dispatch:



jobs:
  build:
    runs-on: ubuntu-latest

    steps:
  
      - name: sfdx installation
        run: |
          wget https://developer.salesforce.com/media/salesforce-cli/sfdx-linux-amd64.tar.xz
          mkdir sfdx-cli
          tar xJf sfdx-linux-amd64.tar.xz -C sfdx-cli --strip-components 1
          ./sfdx-cli/install
      - name: sfdx, git and npm
        run: |
          sfdx --version
          git --version
          npm --version
          
      - name: authorization
        run: |
          
          echo "${{ secrets.JWTKEYFILE }}" > server.key
          sfdx force:auth:jwt:grant --setalias MyOrg --jwtkeyfile server.key --clientid ${{ secrets.CONSUMERKEY }} -u ${{ secrets.USR }}
          sfdx auth:list
          
          git --version
